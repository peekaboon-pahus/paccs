<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Composer Tool - PACCS</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: white;
        }
        
        .header {
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo { font-size: 1.5em; font-weight: bold; }
        .logo span { color: #e94560; }
        
        .back-btn {
            color: white;
            text-decoration: none;
            opacity: 0.8;
        }
        
        .main-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .hero-section {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .hero-section h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .hero-section h1 span { color: #e94560; }
        
        .hero-section p {
            color: #a0aec0;
            font-size: 1.1em;
        }
        
        .form-container {
            background: rgba(255,255,255,0.05);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group { margin-bottom: 20px; }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #a0aec0;
            font-size: 0.9em;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            background: rgba(255,255,255,0.05);
            color: white;
            font-size: 1em;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #e94560;
        }
        
        .form-group input::placeholder { color: #666; }
        
        .btn-analyze {
            width: 100%;
            background: linear-gradient(135deg, #e94560, #c23a51);
            color: white;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .btn-analyze:hover { transform: translateY(-3px); }
        
        .results-container {
            display: none;
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(10px);
        }
        
        .results-container.show { display: block; }
        
        .score-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .main-score {
            font-size: 4em;
            font-weight: bold;
            color: #e94560;
        }
        
        .score-label { color: #a0aec0; }
        
        .mood-badge {
            display: inline-block;
            background: #e94560;
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 15px;
            font-weight: bold;
        }
        
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .score-card {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .score-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #48bb78;
        }
        
        .score-card .label {
            color: #a0aec0;
            font-size: 0.85em;
            margin-top: 5px;
        }
        
        .section-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #e94560;
        }
        
        .film-fits {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .fit-tag {
            background: rgba(233, 69, 96, 0.2);
            border: 1px solid #e94560;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .scene-types {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .scene-tag {
            background: rgba(72, 187, 120, 0.2);
            border: 1px solid #48bb78;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .revenue-box {
            background: linear-gradient(135deg, rgba(72, 187, 120, 0.2), rgba(56, 161, 105, 0.2));
            border: 1px solid #48bb78;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .revenue-box .range {
            font-size: 2em;
            font-weight: bold;
            color: #48bb78;
        }
        
        .revenue-box .label {
            color: #a0aec0;
            margin-top: 5px;
        }
        
        .recommendations {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
        }
        
        .recommendations ul {
            list-style: none;
            padding: 0;
        }
        
        .recommendations li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .recommendations li:last-child { border-bottom: none; }
        
        .btn-new {
            display: block;
            text-align: center;
            margin-top: 25px;
            color: #e94560;
            cursor: pointer;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .form-row { grid-template-columns: 1fr; }
            .scores-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">üéµ <span>PACCS</span> Music Tool</div>
        <a href="/dashboard" class="back-btn">‚Üê Back</a>
    </div>
    
    <div class="main-content">
        <div class="hero-section">
            <h1>Music <span>Composer</span> Tool</h1>
            <p>Analyze your music for film sync licensing potential</p>
        </div>
        
        <div class="form-container" id="formContainer">
            <form id="musicForm" onsubmit="analyzeMusic(event)">
                <div class="form-group">
                    <label>Track Title *</label>
                    <input type="text" id="title" placeholder="Enter your track title" required>
                </div>
                
                <div class="form-group">
                    <label>Artist / Composer Name *</label>
                    <input type="text" id="artist" placeholder="Your name or artist name" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Duration (seconds) *</label>
                        <input type="number" id="duration" placeholder="e.g. 180" required min="10">
                    </div>
                    <div class="form-group">
                        <label>Tempo (BPM) *</label>
                        <input type="number" id="tempo" placeholder="e.g. 120" required min="40" max="200">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Genre *</label>
                        <select id="genre" required>
                            <option value="">Select genre</option>
                            <option value="orchestral">Orchestral</option>
                            <option value="electronic">Electronic</option>
                            <option value="ambient">Ambient</option>
                            <option value="acoustic">Acoustic</option>
                            <option value="rock">Rock</option>
                            <option value="jazz">Jazz</option>
                            <option value="folk">Folk</option>
                            <option value="hip-hop">Hip-Hop</option>
                            <option value="classical">Classical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Has Vocals?</label>
                        <select id="vocals">
                            <option value="no">No - Instrumental</option>
                            <option value="yes">Yes - With Vocals</option>
                        </select>
                    </div>
                </div>
                
                <button type="submit" class="btn-analyze">üéº Analyze Track</button>
            </form>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <div class="score-header">
                <div class="main-score" id="mainScore">8.5</div>
                <div class="score-label">Overall Score</div>
                <div class="mood-badge" id="moodBadge">Uplifting</div>
            </div>
            
            <div class="scores-grid" id="scoresGrid">
                <!-- Filled by JS -->
            </div>
            
            <h3 class="section-title">üé¨ Best Film Genres</h3>
            <div class="film-fits" id="filmFits">
                <!-- Filled by JS -->
            </div>
            
            <h3 class="section-title">üéûÔ∏è Scene Types</h3>
            <div class="scene-types" id="sceneTypes">
                <!-- Filled by JS -->
            </div>
            
            <div class="revenue-box">
                <div class="range" id="revenueRange">$500 - $5,000</div>
                <div class="label">Estimated Sync License Value</div>
            </div>
            
            <h3 class="section-title">üí° Recommendations</h3>
            <div class="recommendations">
                <ul id="recommendations">
                    <!-- Filled by JS -->
                </ul>
            </div>
            
            <div class="btn-new" onclick="resetForm()">‚Üê Analyze Another Track</div>
        </div>
    </div>
    
    <script>
        async function analyzeMusic(e) {
            e.preventDefault();
            
            const trackData = {
                title: document.getElementById('title').value,
                artist: document.getElementById('artist').value,
                duration_seconds: parseInt(document.getElementById('duration').value),
                tempo_bpm: parseInt(document.getElementById('tempo').value),
                genre: document.getElementById('genre').value,
                has_vocals: document.getElementById('vocals').value === 'yes'
            };
            
            try {
                const response = await fetch('/api/analyze-music', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(trackData)
                });
                
                const data = await response.json();
                displayResults(data);
                
            } catch (error) {
                alert('Error analyzing track. Please try again.');
            }
        }
        
        function displayResults(data) {
            document.getElementById('formContainer').style.display = 'none';
            document.getElementById('resultsContainer').classList.add('show');
            
            document.getElementById('mainScore').textContent = data.overall_score.toFixed(1);
            document.getElementById('moodBadge').textContent = data.track_info.detected_mood;
            
            // Scores grid
            const scoresHTML = Object.entries(data.scores).map(([key, value]) => `
                <div class="score-card">
                    <div class="value">${value}</div>
                    <div class="label">${key.replace('_', ' ')}</div>
                </div>
            `).join('');
            document.getElementById('scoresGrid').innerHTML = scoresHTML;
            
            // Film fits
            const fitsHTML = data.film_suitability.best_fit_genres.map(g => 
                `<span class="fit-tag">${g}</span>`
            ).join('');
            document.getElementById('filmFits').innerHTML = fitsHTML;
            
            // Scene types
            const scenesHTML = data.film_suitability.scene_types.map(s => 
                `<span class="scene-tag">${s}</span>`
            ).join('');
            document.getElementById('sceneTypes').innerHTML = scenesHTML;
            
            // Revenue
            document.getElementById('revenueRange').textContent = data.revenue_potential.sync_license_range;
            
            // Recommendations
            const recsHTML = data.recommendations.map(r => 
                `<li>üí° ${r}</li>`
            ).join('');
            document.getElementById('recommendations').innerHTML = recsHTML;
        }
        
        function resetForm() {
            document.getElementById('formContainer').style.display = 'block';
            document.getElementById('resultsContainer').classList.remove('show');
            document.getElementById('musicForm').reset();
        }
    </script>
</body>
</html>